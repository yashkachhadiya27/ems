<div class="container">
  <div class="row align-items-center justify-content-around">
    <div
      class="d-flex flex-column mat-elevation-z5 rounded-3 col-5 me-2"
      style="height: 22rem"
    >
      <div
        class="d-flex justify-content-between align-items-center mt-2"
        style="margin-bottom: 10px; padding: 10px"
      >
        <div class="mx-auto text-center" style="flex: 1">Attendance</div>
        <div class="d-flex align-items-center">
          <span style="cursor: pointer" class="me-2" (click)="changeMonth(-1)">
            <i class="fa fa-chevron-left" style="font-size: 20px"></i>
          </span>
          <span style="cursor: pointer" class="me-2" (click)="changeMonth(1)">
            <i class="fa fa-chevron-right" style="font-size: 20px"></i>
          </span>
        </div>
      </div>
      <div id="attendanceChart"></div>
    </div>
    <div
      class="col-5 d-flex flex-column mat-elevation-z5 rounded-3"
      style="height: 22rem"
    >
      <div
        class="row d-flex align-items-center justify-content-between mt-2 fs-4"
        style="color: #141d31; font-weight: 500"
      >
        <div class="ps-3 col-10" style="flex: 1">Leave Quota</div>
        <div class="col-1">
          <mat-icon
            class="me-1"
            style="cursor: pointer"
            [routerLink]="['/employee/apply-leave']"
            routerLinkActive="router-link-active"
            >add_circle</mat-icon
          >
        </div>
      </div>
      <div class="row">
        <div class="col-6">
          <div class="row mt-2">
            <div id="leavesWithPayContainer"></div>
            <div class="text-center">
              out of <b>{{ leavesToShow.totalLeaves }}</b> Leaves With Pay
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="row mt-2">
            <div id="restrictedLeavesContainer"></div>
            <div class="text-center">out of <b>2</b> Restricted Leaves</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row d-flex align-items-center mt-4">
    <div class="d-flex col-5 mx-auto justify-content-around align-items-center">
      <div
        class="d-flex flex-column col mat-elevation-z5 me-3"
        style="height: 18rem"
      >
        <div class="d-flex mt-2">
          <div class="ps-2 col-10 fw-medium fs-5" style="flex: 1">
            WFH Quota
          </div>
          <div class="col-2 mt-1">
            <mat-icon
              class="me-2"
              style="cursor: pointer"
              [routerLink]="['/employee/apply-leave']"
              routerLinkActive="router-link-active"
              >add_circle</mat-icon
            >
          </div>
        </div>
        <div id="wfhQuotaContainer" class="text-center"></div>

        <div class="wfh-text text-center">
          <p>
            <b>0 WFH</b> available for the next <br />
            <b>30 day/s</b>
          </p>
        </div>
      </div>
      <div
        class="col mat-elevation-z5 justify-content-center"
        style="height: 18rem"
      >
        <div
          class="row mx-auto d-flex mt-2 align-items-center justify-content-center gy-0"
        >
          <div class="col">
            <span class="fw-medium mt-2" style="font-size: 1.05rem"
              >My Projects</span
            >
          </div>
          <div class="col text-end">
            <mat-icon
              class="me-1"
              (click)="addProject()"
              style="cursor: pointer"
              >add_circle</mat-icon
            >
            <mat-icon class="me-1">schedule</mat-icon>
            <mat-icon class="me-1">calendar_month</mat-icon>
          </div>
          <mat-accordion class="example-headers-align overflow-scroll">
            @if(empProjects.length>0) { @for (project of empProjects; track
            $index) {
            <mat-expansion-panel
              [expanded]="step() === 0"
              (opened)="setStep(0)"
              [hideToggle]="empUnderProject"
              class="mt-1 expansion"
              style="background-color: #1e2c4b"
            >
              <mat-expansion-panel-header>
                <mat-panel-title style="color: white">
                  {{ $index + 1 }}
                </mat-panel-title>
                <mat-panel-description class="text-nowrap" style="color: white">
                  {{ project.projectName }}
                </mat-panel-description>
              </mat-expansion-panel-header>
              @if(empUnderProject.length>0) {
              <ul>
                @for (euProject of empUnderProject; track $index) {
                @if(euProject.projectName===project.projectName &&
                userId!==euProject.userId) {
                <li
                  [matTooltip]="moreDetails(euProject)"
                  matTooltipPosition="right"
                  class="mt-2"
                >
                  {{ euProject.fullName | titlecase }}
                </li>
                } }
              </ul>
              }</mat-expansion-panel
            >}}
          </mat-accordion>
        </div>
      </div>
    </div>
    <div
      class="d-flex flex-column col-5 mat-elevation-z5 mx-auto rounded-3"
      style="height: 18rem; cursor: pointer"
      (click)="redirectToTodo()"
    >
      <div class="d-flex mt-2 align-items-center">
        <div><h5>Pending Tasks</h5></div>
        <mat-button-toggle-group
          name="fontStyle"
          aria-label="Font Style"
          class="rounded-3 ms-auto custom-class"
          [(value)]="selectedFilter"
          (click)="$event.stopPropagation()"
          (change)="onFilterChange($event)"
        >
          <mat-button-toggle value="all">All</mat-button-toggle>
          <mat-button-toggle value="progress">Progress</mat-button-toggle>
          <mat-button-toggle value="todo">Todo</mat-button-toggle>
        </mat-button-toggle-group>
      </div>
      <div class="overflow-scroll pe-2">
        @for (task of displayTasks(); track $index) {
        <div
          class="task-item d-flex align-items-center justify-content-between"
        >
          <p>{{ task.description }}</p>
          <mat-chip (click)="$event.stopPropagation()" class="chip">
            {{ task.status }}
          </mat-chip>
        </div>
        } @if(tasks.length===0) { No pending tasks. }
      </div>
    </div>
  </div>
  <div class="row d-flex align-items-center mt-4 justify-content-center">
    <div class="col-6 d-flex justify-content-center align-items-center mt-2">
      <div
        class="row mx-auto d-flex align-items-center col-10 mat-elevation-z5 overflow-scroll"
        style="height: 22rem"
      >
        <div
          class="row d-flex align-self-start position-sticky top-0 align-items-center justify-content-around m-0"
          style="background-color: #d9dee4; margin-top: 0.25px; color: #141d31"
        >
          <div class="col-10" style="flex: 1">
            <h5 class="pt-2" style="color: #141d31">Notice Board</h5>
          </div>
          <div class="col-2 text-end">
            @if(noticeIndex()!==0){
            <span style="cursor: pointer" class="me-2">
              <i
                class="fa fa-chevron-left"
                style="font-size: 20px"
                (click)="previousNotice()"
              ></i> </span
            >} @if(noticeData.length!==(noticeIndex()+1) &&
            noticeData.length>1){
            <span style="cursor: pointer" class="me-1">
              <i
                class="fa fa-chevron-right"
                style="font-size: 20px"
                (click)="nextNotice()"
              ></i> </span
            >}
          </div>
        </div>
        @if (this.noticeData.length>0) {
        <div class="row pt-2" (click)="showNotice()">
          <div>
            <p class="text-center fw-bold">
              {{ noticeData[noticeIndex()].title }}
            </p>
            <hr />
            <p
              [innerHTML]="noticeData[noticeIndex()].content"
              class="content ps-3"
            ></p>
          </div>
        </div>
        } @else {
        <div
          class="row d-flex align-items-center justify-content-center align-self-start"
          style="opacity: 0.5"
        >
          No notice to display
        </div>
        }
      </div>
    </div>

    <div class="d-flex align-items-center justify-content-around col-6">
      <div class="row col-12">
        <div
          class="d-flex flex-column col-5 mat-elevation-z5 mx-auto rounded-3 justify-content-around"
          style="height: 10rem"
          (click)="openRecord('Leave')"
        >
          <app-record-card
            [title]="'Leaves Records'"
            [(records)]="EmployeesOnLeave"
          >
          </app-record-card>
        </div>
        <div
          class="d-flex flex-column col-5 mat-elevation-z5 mx-auto rounded-3 justify-content-around"
          style="height: 10rem"
          (click)="openRecord('WFH')"
        >
          <app-record-card [title]="'WFH Records'" [(records)]="EmployeesOnWfh">
          </app-record-card>
        </div>
        <div
          class="d-flex flex-column col-6 mat-elevation-z5 mx-auto rounded-3 justify-content-around mt-3"
          style="height: 10rem"
          (click)="openRecord('Absent')"
        >
          <app-record-card
            [title]="'Absent Records'"
            [(records)]="absentEmployees"
          >
          </app-record-card>
        </div>
      </div>
    </div>
  </div>
</div>
